import{sendInitialEvent}from"./gaAnalytics";async function extractImageFromPage(e){console.log("inside extract");const a=await fetch(e),t=await a.text(),o=(new DOMParser).parseFromString(t,"text/html").querySelectorAll("img");if(o.length>0)return console.log("imgElements",o),navigator.platform.includes("Mac")?o[1].src:o[0].src;throw new Error("No images found")}function analyzeImage(e,a,t,o,n){e&&(e.match(/\.(jpeg|jpg|gif|png)(\?|$)/)?(a(t,o),n(e)):extractImageFromPage(e).then((e=>{a(t,o),n(e)})).catch((e=>{console.error("Failed to extract direct image URL:",e)})))}export function fetchImageData(e,a,t){console.log("inside imageanalysis.js"),console.log("Sending image URL to Flask API:",e),fetch("https://coloora-400822.et.r.appspot.com/fetch-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageURL:e})}).then((e=>e.json())).then((e=>{e.success&&e.dataURL?a(e.dataURL):t("Image analysis failed: "+e.error)})).catch((e=>{t("Network error: "+e.message)}))}export{extractImageFromPage,analyzeImage};